import e from"react";import{observer as t}from"mobx-react-lite";import{InputGroup as i,Button as a}from"@blueprintjs/core";import{getKey as n}from"../utils/validate-key.js";import{getImageSize as o}from"../utils/image.js";import{ImagesGrid as r}from"./images-grid.js";import{getAPI as l}from"../utils/api.js";export const AiImagesPanel=t(({store:t})=>{const s=e.useRef(null),[m,c]=e.useState(null),[p,g]=e.useState(!1),u=async()=>{g(!0),c(null);const e=await fetch(`${l()}/get-stable-diffusion?KEY=${n()}&prompt=${s.current.value}`);if(g(!1),!e.ok){return void alert("Something went wrong, please try again later...")}const t=await e.json();c(t.output[0])};return e.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column"}},e.createElement("div",{style:{padding:"15px 0"}},"Stable Diffusion is a latent text-to-image diffusion model capable of generating photo-realistic images given any text input"),e.createElement(i,{placeholder:"Type your image generation prompt here...",onKeyDown:e=>{"Enter"===e.key&&u()},style:{marginBottom:"20px"},inputRef:s}),e.createElement(a,{onClick:u,intent:"primary",loading:p,style:{marginBottom:"40px"}},"Generate"),m&&e.createElement(r,{shadowEnabled:!1,images:m?[m]:[],getPreview:e=>e,isLoading:p,onSelect:async(e,i,a)=>{var n;const r=e;if(a&&"svg"===a.type&&a.contentEditable){return void a.set({maskSrc:r})}if(a&&"image"===a.type&&a.contentEditable){return void a.set({src:r})}const{width:l,height:s}=await o(r),m=((null==i?void 0:i.x)||t.width/2)-l/2,c=((null==i?void 0:i.y)||t.height/2)-s/2;null===(n=t.activePage)||void 0===n||n.addElement({type:"image",src:r,width:l,height:s,x:m,y:c})},rowsNumber:1}))});