var e=this&&this.__rest||function(e,t){var r={};for(var o in e){Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o])}if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(o=Object.getOwnPropertySymbols(e);l<o.length;l++){t.indexOf(o[l])<0&&Object.prototype.propertyIsEnumerable.call(e,o[l])&&(r[o[l]]=e[o[l]])}}return r};import t from"react";import{observer as r}from"mobx-react-lite";import{observable as o}from"mobx";import{InputGroup as l}from"@blueprintjs/core";import{Search as a}from"@blueprintjs/icons";import n from"@meronex/icons/ios/IosColorPalette.js";import{ColorPicker as i}from"../toolbar/color-picker.js";import{ImagesGrid as s}from"./images-grid.js";import c from"../utils/styled.js";import{t as m}from"../utils/l10n.js";import{useInfiniteAPI as p}from"../utils/use-api.js";import{unsplashList as u,unsplashDownload as d}from"../utils/api.js";let g="gradient";export const setDefaultQuery=e=>{g=e};const h=o(["white","rgb(82, 113, 255)","rgb(255, 145, 77)","rgb(126, 217, 87)","rgb(255, 222, 89)","rgb(203, 108, 230)","rgb(0, 0, 0, 0)"]);export const setBackgroundColorsPreset=e=>{h.replace(e)};const f=c("div")`
  display: inline-block;
  width: 30px;
  height: 30px;
  border-radius: 2px;
  box-shadow: 0 0 2px rgba(16, 22, 26, 0.3);
  cursor: pointer;
`,b=r=>{var{children:o,color:l}=r,a=e(r,["children","color"]);return t.createElement(f,Object.assign({},a,{style:Object.assign(Object.assign({},a.style),{background:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='15' height='15' viewBox='0 0 8 8'%3E%3Cg fill='rgba(112, 112, 116, 1)' fill-opacity='1'%3E%3Cpath fill-rule='evenodd' d='M0 0h4v4H0V0zm4 4h4v4H4V4z'/%3E%3C/g%3E%3C/svg%3E\")"})}),t.createElement("div",{style:{width:"100%",height:"100%",background:l}},o))};export const BackgroundPanel=r(({store:e})=>{var r,o;const{setQuery:c,loadMore:f,isReachingEnd:v,data:y,isLoading:x,error:E}=p({defaultQuery:g,getAPI:({page:e,query:t})=>u({page:e,query:t})});return t.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column"}},t.createElement("div",{style:{display:"flex",justifyContent:"space-around",paddingBottom:"10px"}},t.createElement(i,{value:(null===(r=e.activePage)||void 0===r?void 0:r.background)||"white",onChange:t=>{var r;null===(r=e.activePage)||void 0===r||r.set({background:t})},store:e,position:"bottom-left",gradientEnabled:!0},t.createElement(b,{color:null===(o=e.activePage)||void 0===o?void 0:o.background,style:{fontSize:"30px"}},t.createElement(n,{style:{mixBlendMode:"difference"}}))),h.map(r=>t.createElement(b,{key:r,color:r,onClick:()=>{var t;null===(t=e.activePage)||void 0===t||t.set({background:r})}}))),t.createElement(l,{leftIcon:t.createElement(a,null),placeholder:m("sidePanel.searchPlaceholder"),onChange:e=>{c(e.target.value||g)},type:"search",style:{marginBottom:"20px"}}),t.createElement("p",{style:{textAlign:"center"}},"Photos by"," ",t.createElement("a",{href:"https://unsplash.com/",target:"_blank"},"Unsplash")),t.createElement(s,{images:null==y?void 0:y.map(e=>e.results).flat().filter(Boolean),isLoading:x,getPreview:e=>e.urls.small,loadMore:!v&&f,onSelect:async t=>{var r;fetch(d(t.id)),null===(r=e.activePage)||void 0===r||r.set({background:t.urls.regular})},error:E,getCredit:e=>t.createElement("span",null,"Photo by"," ",t.createElement("a",{href:`https://unsplash.com/@${e.user.username}?utm_source=polotno&utm_medium=referral`,target:"_blank"},e.user.name)," ","on"," ",t.createElement("a",{href:"https://unsplash.com/?utm_source=polotno&utm_medium=referral",target:"_blank"},"Unsplash"))}))});