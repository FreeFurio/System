import{getImageSize as t}from"../utils/image.js";import{getCrop as e}from"../utils/image.js";export const selectImage=async({src:i,droppedPos:s,targetElement:n,store:d})=>{var a;if(n&&"svg"===n.type&&n.contentEditable){const t=n.parent,e=n.zIndex,s=Object.assign({},n.toJSON());return delete s.id,d.deleteElements([n.id]),void t.addElement(Object.assign(Object.assign({},s),{type:"image",src:i,clipSrc:s.src})).setZIndex(e)}n&&"figure"===n.type&&n.contentEditable;let{width:c,height:o}=await t(i);if(n&&"image"===n.type&&n.contentEditable){const t=e(n,{width:c,height:o});return void n.set(Object.assign({src:i},t))}const r=Math.min(d.width/c,d.height/o,1);c*=r,o*=r;const l=((null==s?void 0:s.x)||d.width/2)-c/2,g=((null==s?void 0:s.y)||d.height/2)-o/2;null===(a=d.activePage)||void 0===a||a.addElement({type:"image",src:i,width:c,height:o,x:l,y:g})};