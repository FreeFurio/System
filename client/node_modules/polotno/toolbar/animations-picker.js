var e=this&&this.__rest||function(e,t){var n={};for(var a in e){Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a])}if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++){t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}}return n};import t from"react";import{Button as n,Position as a,Switch as i,Slider as o,Alignment as l,NumericInput as r,ButtonGroup as m,MenuItem as d,Popover as s}from"@blueprintjs/core";import{Select as c}from"@blueprintjs/select";import{observer as p}from"mobx-react-lite";import{t as u}from"../utils/l10n.js";export const NumberInput=n=>{var{value:a,onValueChange:i}=n,o=e(n,["value","onValueChange"]);const[l,m]=t.useState(a.toString());return t.useEffect(()=>{m(a.toString())},[a]),t.createElement(r,Object.assign({value:l,onValueChange:(e,t)=>{m(t),Number.isNaN(e)||i(e)}},o))};const b=p(({element:e,store:a,enabled:i})=>{const o=e.animations.find(e=>"enter"===e.type),l=e.animations.find(e=>"exit"===e.type);return i?t.createElement(m,{style:{width:"100%"}},t.createElement(n,{fill:!0,active:(null==o?void 0:o.enabled)&&!(null==l?void 0:l.enabled),onClick:()=>{a.history.transaction(()=>{e.setAnimation("enter",{enabled:!0}),e.setAnimation("exit",{enabled:!1})})}},"Enter"),t.createElement(n,{fill:!0,active:(null==o?void 0:o.enabled)&&(null==l?void 0:l.enabled),onClick:()=>{a.history.transaction(()=>{e.setAnimation("enter",{enabled:!0}),e.setAnimation("exit",{enabled:!0})})}},"Both"),t.createElement(n,{fill:!0,active:(null==l?void 0:l.enabled)&&!(null==o?void 0:o.enabled),onClick:()=>{a.history.transaction(()=>{e.setAnimation("enter",{enabled:!1}),e.setAnimation("exit",{enabled:!0})})}},"Exit")):null}),v=(e,{handleClick:n,handleFocus:a,modifiers:i,query:o})=>i.matchesPredicate?t.createElement(d,{active:i.active,disabled:i.disabled,key:e,onClick:n,icon:"arrow-"+e,onFocus:a,roleStructure:"listoption",text:e,shouldDismissPopover:!1}):null,g=["right","left","up","down","bottom-right","bottom-left","top-right","top-left"],h=p(({value:e,onChange:a})=>t.createElement("div",{style:{paddingTop:"10px"}},t.createElement(c,{items:g,itemRenderer:v,filterable:!1,activeItem:e,onItemSelect:e=>{a(e)}},t.createElement(n,{text:e,icon:"arrow-"+e,fill:!0})))),f=p(({element:e,store:n})=>{const a=e.animations.find(e=>"enter"===e.type);return a?t.createElement("div",{style:{padding:"10px"}},t.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingTop:"5px",paddingBottom:"5px"}},t.createElement("div",null,"Delay"),t.createElement("div",null,t.createElement(NumberInput,{value:parseFloat((a.delay/1e3).toFixed(2)),onValueChange:t=>{e.setAnimation("enter",{delay:1e3*t})},style:{width:"50px"},minorStepSize:.01,stepSize:.01,min:0,max:2.5,buttonPosition:"none"}))),t.createElement(o,{min:0,max:1e3,value:a.delay,showTrackFill:!1,labelRenderer:!1,onChange:t=>{e.setAnimation("enter",{delay:t})}})):null}),y=p(({element:e,store:n})=>{const a=e.animations.find(e=>"enter"===e.type);return a?t.createElement("div",{style:{padding:"10px"}},t.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingTop:"5px",paddingBottom:"5px"}},t.createElement("div",null,"Duration"),t.createElement("div",null,t.createElement(NumberInput,{value:parseFloat((a.duration/1e3).toFixed(2)),onValueChange:t=>{e.setAnimation("enter",{duration:1e3*t}),e.setAnimation("exit",{duration:1e3*t})},style:{width:"50px"},minorStepSize:.01,stepSize:.01,min:0,max:2.5,buttonPosition:"none"}))),t.createElement(o,{min:0,max:2500,value:a.duration,showTrackFill:!1,labelRenderer:!1,onChange:t=>{e.setAnimation("enter",{duration:t}),e.setAnimation("exit",{duration:t})}})):null});export const AnimationsPickerOld=p(({element:e,store:o,elements:r})=>{var m,d;const c=r||[e],p=c[0],v=(p.type,p.type,p.type,(e,t)=>{o.history.transaction(()=>{c.forEach(n=>{n.setAnimation("enter",Object.assign({name:e},t)),n.setAnimation("exit",Object.assign(Object.assign({name:e},t),{from:t.to,to:t.from}))})}),t.enabled&&(o.play({animatedElementsIds:c.map(e=>e.id),currentTime:p.page.startTime}),setTimeout(()=>{o.stop()},1e3))}),g=(e,t)=>{var n;return!!((e?null===(n=p.animations)||void 0===n?void 0:n.filter(t=>t.name===e):p.animations)||[]).find(e=>e.enabled)};return t.createElement(s,{hasBackdrop:!1,autoFocus:!1,content:t.createElement("div",{style:{padding:"15px",paddingTop:"25px",width:"230px"}},t.createElement(i,{checked:g("fade"),label:u("toolbar.fade"),onChange:e=>{v("fade",{enabled:e.target.checked})},alignIndicator:l.RIGHT}),t.createElement(i,{checked:g("move"),label:u("toolbar.move"),onChange:e=>{v("move",{enabled:e.target.checked})},alignIndicator:l.RIGHT}),t.createElement(i,{checked:g("zoom"),label:u("toolbar.zoom"),onChange:e=>{v("zoom",{enabled:e.target.checked})},alignIndicator:l.RIGHT}),t.createElement(b,{element:p,store:o,name:"move",enabled:g()}),g("move")&&t.createElement(h,{value:(null===(d=null===(m=p.animations.find(e=>"move"===e.name))||void 0===m?void 0:m.data)||void 0===d?void 0:d.direction)||"right",onChange:e=>{v("move",{data:{direction:e},enabled:!0})}}),g()&&t.createElement(f,{store:o,element:e}),g()&&t.createElement(y,{store:o,element:e}),t.createElement(i,{checked:g("rotate"),label:u("toolbar.rotate"),onChange:e=>{var t;t={enabled:e.target.checked},o.history.transaction(()=>{c.forEach(e=>{e.setAnimation("loop",Object.assign({name:"rotate"},t))})}),t.enabled&&(o.play({animatedElementsIds:c.map(e=>e.id),currentTime:p.page.startTime}),setTimeout(()=>{o.stop()},1e3))},alignIndicator:l.RIGHT})),position:a.BOTTOM},t.createElement(n,{text:u("toolbar.animate"),minimal:!0}))});export const AnimationsPicker=p(({element:e,store:a})=>e.contentEditable?t.createElement(n,{minimal:!0,text:u("toolbar.animate"),onClickCapture:e=>{e.stopPropagation(),a.openSidePanel("animation")}}):null);export default AnimationsPicker;