import e from"react";import{Button as t,OverflowList as r,Position as n,Boundary as o}from"@blueprintjs/core";import{Popover as s}from"@blueprintjs/core";import l from"../utils/styled.js";import{mobileStyle as i}from"../utils/screen.js";import{More as a}from"@blueprintjs/icons";const c=l("div",e.forwardRef)`
  ${i("\n    width: auto !important;\n  ")}
`;export const extendToolbar=({type:e,usedItems:t,components:r})=>{const n=[];return Object.keys(r).forEach(o=>{0===o.toLowerCase().indexOf(e)&&o.toLowerCase()!==e&&(r[o]?t.includes(o)||n.push(o):console.error(`Polotno error: Toolbar has invalid React component "${o}"`))}),t.filter(e=>Boolean(e)).concat(n)};export const ElementContainer=({items:l,itemRender:i})=>{const[m,u]=e.useState(0),p=e.useRef(null),f=()=>{if(null===p.current){return}const e=p.current.parentElement;let t=0;[...p.current.parentElement.children].forEach(e=>{e!==p.current&&(t+=e.offsetWidth)}),u(Math.max(20,e.offsetWidth-t-10))};return e.useLayoutEffect(()=>{f()}),e.useLayoutEffect(()=>{const e=p.current.parentElement,t=null==e?void 0:e.parentElement;if(window.ResizeObserver){const r=new ResizeObserver(f);e&&r.observe(e),t&&r.observe(t);const n=new MutationObserver(f);return e&&n.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style","class"]}),()=>{r.disconnect(),n.disconnect()}}{const e=setInterval(f,100);return()=>clearInterval(e)}},[]),e.createElement(c,{style:{width:m+"px"},ref:p,className:"bp5-navbar-group bp5-align-left"},e.createElement(r,{items:l,style:{width:"100%"},visibleItemRenderer:i,collapseFrom:o.END,overflowRenderer:r=>e.createElement(s,{content:e.createElement("div",{style:{padding:"10px",display:"flex"}},r.map(i)),position:n.BOTTOM},e.createElement(t,{icon:e.createElement(a,null),minimal:!0,style:{marginLeft:"10px"},onMouseDownCapture:e=>{e.preventDefault()}}))}))};