var e=this&&this.__rest||function(e,t){var n={};for(var a in e){Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a])}if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(a=Object.getOwnPropertySymbols(e);l<a.length;l++){t.indexOf(a[l])<0&&Object.prototype.propertyIsEnumerable.call(e,a[l])&&(n[a[l]]=e[a[l]])}}return n};import t from"react";import{Button as n,Position as a,Switch as l,Slider as o,Alignment as r,NumericInput as i}from"@blueprintjs/core";import{Popover as d}from"@blueprintjs/core";import{observer as c}from"mobx-react-lite";import{LeftJoin as s}from"@blueprintjs/icons";import m from"./color-picker.js";import{t as u}from"../utils/l10n.js";const p=(e,t,n)=>Math.max(t,Math.min(n,e));export const NumberInput=n=>{var{value:a,onValueChange:l}=n,o=e(n,["value","onValueChange"]);const[r,d]=t.useState(a.toString());return t.useEffect(()=>{d(a.toString())},[a]),t.createElement(i,Object.assign({value:r,onValueChange:(e,t)=>{d(t),Number.isNaN(e)||l(e)}},o))};const h=({label:e,enabled:n,visible:a=!0,onEnabledChange:d,numberValue:c,onNumberValueChange:s,min:m,max:u})=>a?t.createElement(t.Fragment,null,t.createElement(l,{checked:n,label:e,onChange:e=>{d(e.target.checked)},alignIndicator:r.RIGHT,style:{marginTop:"20px"}}),n&&t.createElement("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"}},t.createElement("div",{style:{paddingTop:"7px"}},t.createElement(o,{value:c,onChange:e=>{s(e)},min:m,max:u,labelStepSize:50,showTrackFill:!1,labelRenderer:!1})),t.createElement(i,{value:c,onValueChange:e=>{s(p(e,m,u))},buttonPosition:"none",style:{width:"45px",padding:"0 5px",marginLeft:"10px"},min:m,max:u}))):null;export const FiltersPicker=c(({element:e,store:c,elements:g})=>{const b=g||[e],x=b[0],E="text"===x.type,y="image"===x.type,f="svg"===x.type,v=y||f,C=e=>{c.history.transaction(()=>{b.forEach(t=>{t.set(e)})})};return t.createElement(d,{content:t.createElement("div",{style:{padding:"15px",paddingTop:"15px",width:"230px",maxHeight:"calc(100vh - 150px)",overflow:"auto"}},t.createElement(h,{label:u("toolbar.blur"),enabled:x.blurEnabled,visible:v||E,onEnabledChange:e=>{C({blurEnabled:e})},numberValue:x.blurRadius,onNumberValueChange:e=>{C({blurRadius:e})},min:0,max:100}),t.createElement(h,{label:u("toolbar.brightness"),visible:v,enabled:x.brightnessEnabled,onEnabledChange:e=>{C({brightnessEnabled:e})},numberValue:100*x.brightness+100,onNumberValueChange:e=>{C({brightness:(e-100)/100})},min:0,max:200}),v&&t.createElement(l,{checked:x.sepiaEnabled,label:u("toolbar.sepia"),onChange:e=>{C({sepiaEnabled:e.target.checked})},alignIndicator:r.RIGHT,style:{marginTop:"20px"}}),v&&t.createElement(l,{checked:x.grayscaleEnabled,label:u("toolbar.grayscale"),onChange:e=>{C({grayscaleEnabled:e.target.checked})},alignIndicator:r.RIGHT,style:{marginTop:"20px"}}),E&&t.createElement(l,{checked:!!x.strokeWidth,label:u("toolbar.textStroke"),onChange:e=>{C({strokeWidth:e.target.checked?2:0})},alignIndicator:r.RIGHT,style:{marginTop:"20px"}}),E&&!!x.strokeWidth&&t.createElement(t.Fragment,null,t.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},t.createElement(m,{value:x.stroke,size:30,onChange:e=>{C({stroke:e})},store:c}),t.createElement(i,{defaultValue:x.strokeWidth,onValueChange:e=>{C({strokeWidth:p(e,1,30)})},style:{width:"80px"},min:1,max:Math.round(x.fontSize/2)}))),E&&t.createElement(l,{checked:!!x.backgroundEnabled,label:u("toolbar.textBackground"),onChange:e=>{C({backgroundEnabled:e.target.checked})},alignIndicator:r.RIGHT,style:{marginTop:"20px"}}),!!x.backgroundEnabled&&t.createElement(t.Fragment,null,t.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingTop:"5px",paddingBottom:"5px"}},t.createElement("div",null,u("toolbar.backgroundCornerRadius")),t.createElement("div",null,t.createElement(NumberInput,{value:100*x.backgroundCornerRadius,onValueChange:e=>{C({backgroundCornerRadius:p(e,0,100)/100})},style:{width:"50px"},min:0,max:100,buttonPosition:"none"}))),t.createElement(o,{value:100*x.backgroundCornerRadius,onChange:e=>{C({backgroundCornerRadius:p(e,0,100)/100})},min:0,max:100,labelRenderer:!1}),t.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingTop:"5px",paddingBottom:"5px"}},t.createElement("div",null,u("toolbar.backgroundPadding")),t.createElement("div",null,t.createElement(NumberInput,{value:Math.round(100*x.backgroundPadding),onValueChange:e=>{C({backgroundPadding:p(e,0,100)/100})},style:{width:"50px"},min:0,max:100,buttonPosition:"none"}))),t.createElement(o,{value:Math.round(100*x.backgroundPadding),onChange:e=>{C({backgroundPadding:p(e,0,100)/100})},min:0,max:100,labelRenderer:!1}),t.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingTop:"5px",paddingBottom:"5px"}},t.createElement("div",null,u("toolbar.opacity")),t.createElement("div",null,t.createElement(NumberInput,{value:Math.round(100*x.backgroundOpacity),onValueChange:e=>{C({backgroundOpacity:e/100})},style:{width:"50px"},min:0,max:100,buttonPosition:"none"}))),t.createElement(o,{value:100*x.backgroundOpacity,onChange:e=>{C({backgroundOpacity:e/100})},min:0,max:100,labelRenderer:!1}),t.createElement("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:"5px",paddingBottom:"5px"}},t.createElement("div",{style:{lineHeight:"30px"}},u("toolbar.color")),t.createElement(m,{value:x.backgroundColor,size:30,onChange:e=>{C({backgroundColor:e})},store:c}))),v&&t.createElement(l,{checked:!!x.borderSize,label:u("toolbar.border"),onChange:e=>{C({borderSize:e.target.checked?2:0})},alignIndicator:r.RIGHT,style:{marginTop:"20px"}}),!!x.borderSize&&t.createElement(t.Fragment,null,t.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},t.createElement(m,{value:x.borderColor,size:30,onChange:e=>{C({borderColor:e})},store:c}),t.createElement(i,{defaultValue:x.borderSize,onValueChange:e=>{C({borderSize:p(e,1,Math.min(x.width,x.height)/2)})},style:{width:"80px"},min:1,max:Math.max(1,Math.min(x.width,x.height)/2)}))),v&&t.createElement(l,{checked:!!x.cornerRadius,label:u("toolbar.cornerRadius"),onChange:e=>{C({cornerRadius:e.target.checked?Math.min(x.width/4,x.height/4):0})},alignIndicator:r.RIGHT,style:{marginTop:"20px"}}),v&&!!x.cornerRadius&&t.createElement("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"}},t.createElement("div",{style:{width:"150px",paddingTop:"7px"}},t.createElement(o,{value:Math.min(x.cornerRadius,Math.round(Math.min(x.width/2,x.height/2))),onChange:e=>{C({cornerRadius:e})},min:1,max:Math.round(Math.min(x.width/2,x.height/2)),labelStepSize:50,showTrackFill:!1,labelRenderer:!1})),t.createElement(i,{value:x.cornerRadius,onValueChange:e=>{C({cornerRadius:p(e,1,Math.min(x.width,x.height)/2)})},buttonPosition:"none",style:{width:"45px",padding:"0 5px"},min:1,max:Math.round(Math.min(x.width/2,x.height/2))})),t.createElement(l,{checked:x.shadowEnabled,label:u("toolbar.shadow"),onChange:e=>{C({shadowEnabled:e.target.checked})},alignIndicator:r.RIGHT,style:{marginTop:"20px"}}),x.shadowEnabled&&t.createElement(t.Fragment,null,t.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingTop:"5px",paddingBottom:"5px"}},t.createElement("div",null,u("toolbar.blur")),t.createElement("div",null,t.createElement(NumberInput,{value:x.shadowBlur,onValueChange:e=>{C({shadowBlur:p(e,-50,50)})},style:{width:"50px"},min:0,max:50,buttonPosition:"none"}))),t.createElement(o,{value:x.shadowBlur,onChange:e=>{C({shadowBlur:e})},min:0,max:50,showTrackFill:!1,labelRenderer:!1}),t.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingTop:"5px",paddingBottom:"5px"}},t.createElement("div",null,u("toolbar.offsetX")),t.createElement("div",null,t.createElement(NumberInput,{value:x.shadowOffsetX,onValueChange:e=>{C({shadowOffsetX:p(e,-50,50)})},style:{width:"50px"},min:-50,max:50,buttonPosition:"none"}))),t.createElement(o,{value:x.shadowOffsetX,onChange:e=>{C({shadowOffsetX:e})},min:-50,max:50,showTrackFill:!1,labelRenderer:!1}),t.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingTop:"5px",paddingBottom:"5px"}},t.createElement("div",null,u("toolbar.offsetY")),t.createElement("div",null,t.createElement(NumberInput,{value:x.shadowOffsetY,onValueChange:e=>{C({shadowOffsetY:p(e,-50,50)})},style:{width:"50px"},min:-50,max:50,buttonPosition:"none"}))),t.createElement(o,{value:x.shadowOffsetY,onChange:e=>{C({shadowOffsetY:e})},min:-50,max:50,showTrackFill:!1,labelRenderer:!1}),t.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingTop:"5px",paddingBottom:"5px"}},t.createElement("div",null,u("toolbar.opacity")),t.createElement("div",null,t.createElement(NumberInput,{value:Math.round(100*x.shadowOpacity),onValueChange:e=>{C({shadowOpacity:e/100})},style:{width:"50px"},min:0,max:100,buttonPosition:"none"}))),t.createElement(o,{value:100*x.shadowOpacity,onChange:e=>{C({shadowOpacity:e/100})},min:0,max:100,labelRenderer:!1}),t.createElement("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:"5px",paddingBottom:"5px"}},t.createElement("div",{style:{lineHeight:"30px"}},u("toolbar.color")),t.createElement(m,{value:x.shadowColor,size:30,onChange:e=>{C({shadowColor:e})},store:c})))),position:a.BOTTOM},t.createElement(n,{icon:t.createElement(s,null),text:u("toolbar.effects"),minimal:!0}))});export const EffectsPicker=c(({element:e,store:a})=>e.contentEditable?t.createElement(n,{minimal:!0,icon:t.createElement(s,null),text:u("toolbar.effects"),onClickCapture:e=>{e.stopPropagation(),a.openSidePanel("effects")}}):null);export default EffectsPicker;