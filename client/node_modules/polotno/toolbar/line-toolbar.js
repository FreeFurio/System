import e from"react";import{observer as t}from"mobx-react-lite";import{Button as r,Position as n,Slider as o}from"@blueprintjs/core";import{Popover as i}from"@blueprintjs/core";import{Settings as a}from"@blueprintjs/icons";import s from"./color-picker.js";import{AnimationsPicker as l}from"./animations-picker.js";import{NumberInput as c}from"./filters-picker.js";import{ElementContainer as m,extendToolbar as d}from"./element-container.js";import{getMiddlePoints as p,getLinePositionFromMiddlePoints as h}from"../canvas/line-element.js";import{t as g}from"../utils/l10n.js";import{flags as E}from"../utils/flags.js";export const LineSettings=t(({store:t,elements:s})=>{const l=e=>{t.history.transaction(()=>{s.forEach(t=>{t.set(e)})})},m=e=>{t.history.transaction(()=>{s.forEach(t=>{const{middleLeft:r,middleRight:n}=p(t),{x:o,y:i,rotation:a}=h(r,n,e);t.set({x:o,y:i,rotation:a,height:e})})})};return e.createElement(i,{content:e.createElement("div",{style:{padding:"15px",paddingTop:"15px",width:"230px"}},e.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingBottom:"5px"}},e.createElement("div",null,g("toolbar.lineSize")),e.createElement("div",null,e.createElement(c,{value:s[0].height,onValueChange:e=>{m(e)},style:{width:"50px"},min:1,max:100,buttonPosition:"none"}))),e.createElement(o,{value:s[0].height,onChange:e=>{m(e)},min:1,max:100,labelRenderer:!1}),e.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingBottom:"5px",paddingTop:"15px"}},e.createElement(r,{onClick:()=>{l({dash:[]})},active:0===s[0].dash.length},e.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e.createElement("line",{x2:"24",y1:"50%",y2:"50%",stroke:"currentColor",strokeWidth:"2"}))),e.createElement(r,{onClick:()=>{l({dash:[4,1]})},active:4===s[0].dash[0]},e.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e.createElement("line",{x1:"-1",x2:"25",y1:"50%",y2:"50%",stroke:"currentColor",strokeDasharray:"12 2",strokeWidth:"2"}))),e.createElement(r,{onClick:()=>{l({dash:[2,1]})},active:2===s[0].dash[0]},e.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e.createElement("line",{x1:"1",x2:"23",y1:"50%",y2:"50%",stroke:"currentColor",strokeDasharray:"6 2",strokeWidth:"2"}))),e.createElement(r,{onClick:()=>{l({dash:[1,1]})},active:1===s[0].dash[0]},e.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e.createElement("line",{x1:"1",x2:"23",y1:"50%",y2:"50%",stroke:"currentColor",strokeDasharray:"2 2",strokeWidth:"2"}))))),position:n.BOTTOM},e.createElement(r,{icon:e.createElement(a,null),minimal:!0}))});export const LineColor=t(({elements:t,store:r})=>e.createElement(s,{value:t[0].color,style:{marginRight:"5px"},gradientEnabled:!1,onChange:e=>r.history.transaction(()=>{t.forEach(t=>{t.set({color:e})})}),store:r}));const u={"":e.createElement("span",{"aria-hidden":"true",className:"bp5-icon"},e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},e.createElement("path",{stroke:"currentColor",strokeWidth:"2",d:"M 1 8 L 16 8"}))),arrow:e.createElement("span",{"aria-hidden":"true",className:"bp5-icon"},e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},e.createElement("path",{stroke:"currentColor",strokeWidth:"2",d:"M 8 3 L 1 8 L 8 13",fill:"none",strokeLinejoin:"round",strokeLinecap:"round"}),e.createElement("path",{stroke:"currentColor",strokeWidth:"2",d:"M 1 8 L 15 8",strokeLinejoin:"round",strokeLinecap:"round"}))),triangle:e.createElement("span",{"aria-hidden":"true",className:"bp5-icon"},e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},e.createElement("path",{stroke:"currentColor",strokeWidth:"2",d:"M 8 3 L 1 8 L 8 13 Z",fill:"currentColor",strokeLinejoin:"round",strokeLinecap:"round"}),e.createElement("path",{stroke:"currentColor",strokeWidth:"2",d:"M 1 8 L 15 8",strokeLinejoin:"round",strokeLinecap:"round"}))),bar:e.createElement("span",{"aria-hidden":"true",className:"bp5-icon"},e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},e.createElement("path",{stroke:"currentColor",strokeWidth:"2",d:"M 1 3 L 1 13",strokeLinejoin:"round",strokeLinecap:"round"}),e.createElement("path",{stroke:"currentColor",strokeWidth:"2",d:"M 1 8 L 15 8",strokeLinejoin:"round",strokeLinecap:"round"}))),square:e.createElement("span",{"aria-hidden":"true",className:"bp5-icon"},e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},e.createElement("path",{stroke:"currentColor",strokeWidth:"2",d:"M 1 4 L 9 4 L 9 12 L 1 12 Z",fill:"currentColor",strokeLinejoin:"round",strokeLinecap:"round"}),e.createElement("path",{stroke:"currentColor",strokeWidth:"2",d:"M 1 8 L 15 8",strokeLinejoin:"round",strokeLinecap:"round"}))),circle:e.createElement("span",{"aria-hidden":"true",className:"bp5-icon"},e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},e.createElement("circle",{cx:"4",cy:"8",r:"4",fill:"currentColor"}),e.createElement("path",{stroke:"currentColor",strokeWidth:"2",d:"M 1 8 L 15 8",strokeLinejoin:"round",strokeLinecap:"round"})))},k=({type:t,active:n,onClick:o,flipped:i})=>{const a=u[t];return e.createElement(r,{icon:i?e.createElement("span",{style:{transform:"scaleX(-1)"}},a):a,minimal:!0,onClick:o,active:n})};export const BasicHead=t(({elements:t,store:o,property:a})=>{const s="endHead"===a,l=u[t[0][a]],c=s?e.createElement("span",{style:{transform:"scaleX(-1)"}},l):l,m=e=>{o.history.transaction(()=>{t.forEach(t=>{t.set({[a]:e})})})};return e.createElement(e.Fragment,null,e.createElement(i,{content:e.createElement("div",{style:{width:"150px",padding:"10px"}},e.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},["","arrow","triangle"].map(r=>e.createElement(k,{key:r,type:r,active:t[0][a]===r,onClick:()=>{m(r)},flipped:s}))),e.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},["bar","square","circle"].map(r=>e.createElement(k,{key:r,type:r,active:t[0][a]===r,onClick:()=>{m(r)},flipped:s})))),position:n.BOTTOM},e.createElement(r,{icon:c,minimal:!0})))});export const LineHeads=t(({elements:t,store:r})=>e.createElement(e.Fragment,null,e.createElement(BasicHead,{elements:t,store:r,property:"startHead"}),e.createElement(BasicHead,{elements:t,store:r,property:"endHead"})));const w={LineSettings,LineColor,LineHeads,LineAnimations:l};export const LineToolbar=t(({store:t,components:r})=>{const n=t.selectedElements[0],o=["LineColor","LineSettings","LineHeads",E.animationsEnabled&&"LineAnimations"].filter(e=>Boolean(e)),i=d({type:"line",usedItems:o,components:r});return e.createElement(m,{items:i,itemRender:o=>{const i=r[o]||w[o];return e.createElement(i,{element:n,store:t,key:o,elements:t.selectedElements})}})});export default LineToolbar;