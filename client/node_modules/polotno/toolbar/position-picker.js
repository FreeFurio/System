import e from"react";import{observer as t}from"mobx-react-lite";import{Button as l,Position as o,Menu as n,MenuItem as i,MenuDivider as c}from"@blueprintjs/core";import{Popover as a}from"@blueprintjs/core";import{Layers as s,ChevronUp as r,ChevronDown as m,DoubleChevronUp as d,DoubleChevronDown as h,AlignmentLeft as E,AlignmentRight as v,AlignmentVerticalCenter as u,AlignmentHorizontalCenter as g,AlignmentTop as p,AlignmentBottom as x,VerticalDistribution as y,HorizontalDistribution as P}from"@blueprintjs/icons";import{getClientRect as f}from"../utils/math.js";import{t as b}from"../utils/l10n.js";const M=e=>{if("group"!==e.type){return f(e)}let t=1/0,l=1/0,o=-1/0,n=-1/0;return e.children.forEach(e=>{const i=M(e);t=Math.min(t,i.x),l=Math.min(l,i.y),o=Math.max(o,i.x+i.width),n=Math.max(n,i.y+i.height)}),{x:t,y:l,width:o-t,height:n-l}},w=(e,t,l)=>{if("group"!==e.type){const o=f(e),n=t-o.x,i=l-o.y;e.set({x:e.x+n,y:e.y+i})}else{const o=t-M(e).x,n=l-M(e).y;e.children.forEach(e=>{const t=M(e);w(e,t.x+o,t.y+n)})}};export const PositionPicker=t(({store:t})=>{var f,D,k,C;const j=t.selectedElements.length>0,B=t.selectedElementsIds,H=t.selectedElements.every(e=>e.draggable),T=H&&t.selectedElements.length>1;return e.createElement(a,{disabled:!j,content:e.createElement(n,{style:{width:"280px"}},e.createElement(c,{title:b("toolbar.layering")}),e.createElement("div",{style:{display:"flex"}},e.createElement("div",{style:{width:"50%"}},e.createElement(i,{shouldDismissPopover:!1,icon:e.createElement(r,null),text:b("toolbar.up"),disabled:!(null===(f=t.activePage)||void 0===f?void 0:f.canMoveElementsUp(B)),onClick:()=>{var e;null===(e=t.activePage)||void 0===e||e.moveElementsUp(B)}}),e.createElement(i,{shouldDismissPopover:!1,icon:e.createElement(d,null),text:b("toolbar.toForward"),disabled:!(null===(D=t.activePage)||void 0===D?void 0:D.canMoveElementsTop(B)),onClick:()=>{var e;null===(e=t.activePage)||void 0===e||e.moveElementsTop(B)}})),e.createElement("div",{style:{width:"50%"}},e.createElement(i,{shouldDismissPopover:!1,icon:e.createElement(m,null),text:b("toolbar.down"),disabled:!(null===(k=t.activePage)||void 0===k?void 0:k.canMoveElementsDown(B)),onClick:()=>{var e;null===(e=t.activePage)||void 0===e||e.moveElementsDown(B)}}),e.createElement(i,{shouldDismissPopover:!1,icon:e.createElement(h,null),text:b("toolbar.toBottom"),disabled:!(null===(C=t.activePage)||void 0===C?void 0:C.canMoveElementsBottom(B)),onClick:()=>{var e;null===(e=t.activePage)||void 0===e||e.moveElementsBottom(B)}}))),H&&e.createElement(e.Fragment,null,e.createElement(c,{title:b("toolbar.position")}),e.createElement("div",{style:{display:"flex"}},e.createElement("div",{style:{width:"50%"}},e.createElement(i,{shouldDismissPopover:!1,icon:e.createElement(E,null),text:b("toolbar.alignLeft"),onClick:()=>{var e;let l=null===(e=t.activePage)||void 0===e?void 0:e.computedWidth;t.selectedElements.forEach(e=>{l=Math.min(l,M(e).x)}),1===t.selectedElements.length&&(l=0),t.selectedElements.forEach(e=>{const t=M(e);w(e,t.x-t.x+l,t.y)})}}),e.createElement(i,{shouldDismissPopover:!1,icon:e.createElement(u,null),text:b("toolbar.alignCenter"),onClick:()=>{var e,l;let o=null===(e=t.activePage)||void 0===e?void 0:e.computedWidth,n=0;t.selectedElements.forEach(e=>{const t=M(e);o=Math.min(o,t.x),n=Math.max(n,t.x+t.width)});let i=(n+o)/2;1===t.selectedElements.length&&(i=(null===(l=t.activePage)||void 0===l?void 0:l.computedWidth)/2),t.selectedElements.forEach(e=>{const t=M(e);w(e,i-t.width/2,t.y)})}}),e.createElement(i,{shouldDismissPopover:!1,icon:e.createElement(v,null),text:b("toolbar.alignRight"),onClick:()=>{var e;let l=0;t.selectedElements.forEach(e=>{const t=M(e);l=Math.max(l,t.x+t.width)}),1===t.selectedElements.length&&(l=null===(e=t.activePage)||void 0===e?void 0:e.computedWidth),t.selectedElements.forEach(e=>{const t=M(e);w(e,l-t.width,t.y)})}})),e.createElement("div",{style:{width:"50%"}},e.createElement(i,{shouldDismissPopover:!1,icon:e.createElement(p,null),text:b("toolbar.alignTop"),onClick:()=>{var e;let l=null===(e=t.activePage)||void 0===e?void 0:e.computedHeight;t.selectedElements.forEach(e=>{l=Math.min(l,M(e).y)}),1===t.selectedElements.length&&(l=0),t.selectedElements.forEach(e=>{const t=M(e);w(e,t.x,t.y-t.y+l)})}}),e.createElement(i,{shouldDismissPopover:!1,icon:e.createElement(g,null),text:b("toolbar.alignMiddle"),onClick:()=>{var e,l;let o=null===(e=t.activePage)||void 0===e?void 0:e.computedHeight,n=0;t.selectedElements.forEach(e=>{const t=M(e);o=Math.min(o,t.y),n=Math.max(n,t.y+t.height)});let i=(n+o)/2;1===t.selectedElements.length&&(i=(null===(l=t.activePage)||void 0===l?void 0:l.computedHeight)/2),t.selectedElements.forEach(e=>{const t=M(e);w(e,t.x,i-t.height/2)})}}),e.createElement(i,{shouldDismissPopover:!1,icon:e.createElement(x,null),text:b("toolbar.alignBottom"),onClick:()=>{var e;let l=0;t.selectedElements.forEach(e=>{const t=M(e);l=Math.max(l,t.y+t.height)}),1===t.selectedElements.length&&(l=null===(e=t.activePage)||void 0===e?void 0:e.computedHeight),t.selectedElements.forEach(e=>{const t=M(e);w(e,t.x,l-t.height)})}})))),T&&e.createElement(e.Fragment,null,e.createElement(c,{title:b("toolbar.spaceEvenly")}),e.createElement("div",{style:{display:"flex"}},e.createElement("div",{style:{width:"50%"}},e.createElement(i,{shouldDismissPopover:!1,icon:e.createElement(y,null),text:b("toolbar.verticalDistribution"),onClick:()=>{var e;let l=null===(e=t.activePage)||void 0===e?void 0:e.computedHeight,o=0,n=0;t.selectedElements.forEach(e=>{const t=M(e);l=Math.min(l,t.y),o=Math.max(o,t.y+t.height),n+=t.height});const i=(o-l-n)/(t.selectedElements.length-1),c=t.selectedElements.slice().sort((e,t)=>{const l=M(e),o=M(t);return l.y-o.y});let a=0;c.forEach(e=>{const t=M(e);w(e,t.x,l+a),a+=t.height+i})}})),e.createElement("div",{style:{width:"50%"}},e.createElement(i,{shouldDismissPopover:!1,icon:e.createElement(P,null),text:b("toolbar.horizontalDistribution"),onClick:()=>{var e;let l=null===(e=t.activePage)||void 0===e?void 0:e.computedWidth,o=0,n=0;t.selectedElements.forEach(e=>{const t=M(e);l=Math.min(l,t.x),o=Math.max(o,t.x+t.width),n+=t.width});const i=(o-l-n)/(t.selectedElements.length-1),c=t.selectedElements.slice().sort((e,t)=>{const l=M(e),o=M(t);return l.x-o.x});let a=0;c.forEach(e=>{const t=M(e);w(e,l+a,t.y),a+=t.width+i})}}))))),position:o.BOTTOM},e.createElement(l,{icon:e.createElement(s,null),minimal:!0,text:b("toolbar.position"),disabled:!j}))});