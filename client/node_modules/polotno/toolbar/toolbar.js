import e from"react";import{observer as t}from"mobx-react-lite";import{Navbar as o,Alignment as r,Divider as l}from"@blueprintjs/core";import n from"../utils/styled.js";import{mobileStyle as m}from"../utils/screen.js";import{HistoryButtons as i}from"./history-buttons.js";import{TextToolbar as s}from"./text-toolbar.js";import{HtmlToolbar as a}from"./html-toolbar.js";import{ImageToolbar as p}from"./image-toolbar.js";import{SvgToolbar as c}from"./svg-toolbar.js";import{LineToolbar as d}from"./line-toolbar.js";import{VideoToolbar as u}from"./video-toolbar.js";import{FigureToolbar as f}from"./figure-toolbar.js";import{GifToolbar as b}from"./gif-toolbar.js";import{ManyToolbar as j}from"./many-toolbar.js";import{PageToolbar as E}from"./page-toolbar.js";import{DownloadButton as g}from"./download-button.js";import{DuplicateButton as y}from"./duplicate-button.js";import{RemoveButton as v}from"./remove-button.js";import{LockButton as h}from"./lock-button.js";import{PositionPicker as x}from"./position-picker.js";import{OpacityPicker as w}from"./opacity-picker.js";import{AdminButton as k}from"./admin-button.js";import{GroupButton as O}from"./group-button.js";import{flags as R}from"../utils/flags.js";import{CopyStyleButton as T}from"./copy-style.js";const A={text:s,image:p,svg:c,many:j,line:d,video:u,figure:f,gif:b,page:E};export function registerToolbarComponent(e,t){A[e]=t}const C=n("div")`
  white-space: nowrap;

  /* Add special style for a button with text inside, to make sure it has good with */
  & .bp5-button:has(.bp5-button-text) {
    min-width: max-content;
  }

  ${m("\n    max-width: 100vw;\n    overflow-x: auto;\n    overflow-y: hidden;\n  ")}
`,G=n("div")`
  width: 100%;
  height: 100%;
  ${m("\n    display: flex;\n  ")}
`;export const Toolbar=t(({store:t,downloadButtonEnabled:n,components:m={}})=>{const s=1===new Set(t.selectedElements.map(e=>e.type)).size,p=1===t.selectedElements.length,c=t.selectedElements[0],d=t.selectedElements.every(e=>e.styleEditable);let u=d&&p&&A[c.type];s?u=A[c.type]:t.selectedElements.length>1&&(u=A.many),0===t.selectedElements.length&&(u=A.page),p&&"text"===c.type&&R.htmlRenderEnabled&&(u=a);const f=p&&c._cropModeEnabled,b=e.useRef(m);(Object.keys(m).some(e=>m[e]!==b.current[e])||Object.keys(b.current).some(e=>!(e in m)))&&(b.current=Object.assign({},m));const j=b.current,E=(null==j?void 0:j.ActionControls)||(n?g:null),H=(null==j?void 0:j.Position)||x,S=(null==j?void 0:j.Opacity)||w,$=(null==j?void 0:j.Lock)||h,z=(null==j?void 0:j.Duplicate)||y,B=(null==j?void 0:j.Remove)||v,D=(null==j?void 0:j.Group)||O,F=(null==j?void 0:j.History)||i,I=(null==j?void 0:j.Admin)||k,L=(null==j?void 0:j.CopyStyle)||T;return e.createElement(C,{className:"bp5-navbar polotno-toolbar"},e.createElement(G,null,!f&&e.createElement(F,{store:t}),u&&d&&e.createElement(u,{store:t,components:j}),!f&&e.createElement(o.Group,{align:r.RIGHT},"admin"===t.role&&e.createElement(I,{store:t}),e.createElement(D,{store:t}),e.createElement(H,{store:t}),d&&e.createElement(S,{store:t}),e.createElement($,{store:t}),e.createElement(z,{store:t}),e.createElement(B,{store:t}),e.createElement(L,{store:t}),E&&e.createElement(e.Fragment,null,e.createElement(l,{style:{height:"100%",margin:"0 15px"}}),e.createElement(E,{store:t})))))});export default Toolbar;