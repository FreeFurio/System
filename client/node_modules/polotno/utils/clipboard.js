import{forEveryChild as e}from"../model/group-model.js";import{getTotalClientRect as t}from"./math.js";let a={data:[],pageId:""};const o="polotno_clipboard",l=(e,t)=>{a={data:JSON.parse(JSON.stringify(e)),pageId:t};try{localStorage.setItem(o,JSON.stringify(e)),localStorage.setItem(o+"_page",t)}catch(l){}},i=()=>{try{const e=localStorage.getItem(o),t=localStorage.getItem(o+"_page");if(e){return{data:JSON.parse(e),pageId:t}}}catch(e){}return a};export const copy=e=>{var t;0!==e.selectedElements.length&&l(e.selectedElements.map(e=>e.toJSON()),null===(t=e.activePage)||void 0===t?void 0:t.id)};export const cut=e=>{var t;l(e.selectedElements.map(e=>e.toJSON()),null===(t=e.activePage)||void 0===t?void 0:t.id);let a=e.selectedElements.filter(e=>e.removable).map(e=>e.id);e.deleteElements(a)};export const paste=a=>{a.history.transaction(()=>{var o,d;let r=0,s=0;const{data:c,pageId:n}=i();if(n===(null===(o=a.activePage)||void 0===o?void 0:o.id)){r=a.width/20,s=a.height/20}else{const o=[];e({children:c},e=>{"group"!==e.type&&o.push(e)});const l=t(o);l.maxX>a.width&&(r=-l.minX),l.maxY>a.height&&(s=-l.minY)}const p=[];e({children:c},e=>{delete e.id,"group"!==e.type&&(e.x+=r,e.y+=s)}),c.forEach(e=>{var t;const o=null===(t=a.activePage)||void 0===t?void 0:t.addElement(e);o&&p.push(o.id)}),l(c,null===(d=a.activePage)||void 0===d?void 0:d.id),a.selectElements(p)})};export const isClipboardEmpty=()=>0===i().data.length;