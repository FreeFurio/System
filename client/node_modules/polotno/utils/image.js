import{getSvgSize as t}from"./svg.js";export function getImageSize(e){return new Promise(h=>{const i=document.createElement("img");i.onload=async()=>{0===i.width||0===i.height?h(await t(e)):h({width:i.width,height:i.height})},i.crossOrigin="anonymous",i.src=e})}export function loadImage(t){return new Promise((e,h)=>{const i=document.createElement("img");i.onload=()=>{e(i)},i.onerror=t=>{h(t)},i.crossOrigin="anonymous",i.src=t})}export async function cropImage(t,e){const h=await loadImage(t),i=document.createElement("canvas");i.width=2*h.width,i.height=2*h.height,i.getContext("2d").drawImage(h,0,0,i.width,i.height);const o=document.createElement("canvas");o.width=e.width,o.height=e.height;const n=o.getContext("2d");let{cropX:r,cropY:g}=e;const c=i.width*e.cropWidth,d=i.height*e.cropHeight,a=e.width/e.height;let s,w;const m=c/d;return"svg"===e.type?(s=c,w=d):a>=m?(s=c,w=c/a):(s=d*a,w=d),n.drawImage(i,r*i.width,g*i.height,s,w,0,0,o.width,o.height),o.toDataURL("image/png")}export function getCrop(t,e){const{width:h,height:i}=t,o=h/i;let n,r;o>=e.width/e.height?(n=e.width,r=e.width/o):(n=e.height*o,r=e.height);const g=(e.width-n)/2,c=(e.height-r)/2;return{cropX:g/e.width,cropY:c/e.height,cropWidth:n/e.width,cropHeight:r/e.height}}